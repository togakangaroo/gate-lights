<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Acrylic Rod Lighting Simulator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background: #d3d3d3;
            color: #333;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        h1 {
            margin-bottom: 20px;
            font-size: 24px;
        }

        .info {
            margin-bottom: 20px;
            text-align: center;
            color: #666;
            font-size: 14px;
        }

        .simulator-container {
            background: #e8e8e8;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .rods-container {
            display: flex;
            align-items: flex-end;
            gap: 60px; /* 6 inches * 10px per inch = 60px */
            padding: 20px;
            background: #f5f5f5;
            border-radius: 4px;
        }

        .rod-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }

        .rod {
            width: 16px; /* 5px looks more accurate, but this is a better visualization */
            height: 600px; /* 5 feet * 12 inches/foot * 10px per inch = 600px */
            background: transparent;
            border: 1px solid #000;
            border-radius: 2px;
            box-shadow: none;
            transition: all 0.3s ease;
        }

        .rod:hover {
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
        }

        .led-checkbox {
            width: 16px;
            height: 16px;
            cursor: pointer;
        }

        .checkbox-label {
            font-size: 10px;
            color: #666;
            user-select: none;
        }

        .specs {
            margin-top: 10px;
            padding: 10px;
            background: #f5f5f5;
            border-radius: 4px;
            font-size: 12px;
            color: #666;
        }

        .control-panel {
            margin-top: 30px;
            padding: 20px;
            background: #e8e8e8;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .control-panel h2 {
            font-size: 18px;
            margin-bottom: 15px;
            color: #333;
        }

        .pattern-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .pattern-option {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
        }

        .pattern-option input[type="radio"] {
            cursor: pointer;
        }

        .pattern-option label {
            cursor: pointer;
            user-select: none;
        }
    </style>
</head>
<body>
    <h1>Acrylic Rod Lighting Simulator</h1>

    <div class="info">
        <p style="max-width: 600px; margin: 0 auto 15px; line-height: 1.5;">
            This simulator represents an art installation featuring vertical acrylic rods with LED lights at each end.
            Use the checkboxes to toggle lights on and off, experimenting with different patterns to visualize how the illuminated rods will look in the final display.
        </p>
        <div>6 acrylic rods: 5ft tall Ã— 0.5" wide, spaced 6" apart</div>
        <div class="specs">Scale: 10px = 1 inch</div>
    </div>

    <div class="simulator-container">
        <div class="rods-container" id="rodsContainer">
            <div class="rod-wrapper">
                <input type="checkbox" class="led-checkbox" data-light="1" data-rod="1" data-end="top" id="led-1">
                <div class="rod" data-rod="1"></div>
                <input type="checkbox" class="led-checkbox" data-light="7" data-rod="1" data-end="bottom" id="led-7">
            </div>
            <div class="rod-wrapper">
                <input type="checkbox" class="led-checkbox" data-light="2" data-rod="2" data-end="top" id="led-2">
                <div class="rod" data-rod="2"></div>
                <input type="checkbox" class="led-checkbox" data-light="8" data-rod="2" data-end="bottom" id="led-8">
            </div>
            <div class="rod-wrapper">
                <input type="checkbox" class="led-checkbox" data-light="3" data-rod="3" data-end="top" id="led-3">
                <div class="rod" data-rod="3"></div>
                <input type="checkbox" class="led-checkbox" data-light="9" data-rod="3" data-end="bottom" id="led-9">
            </div>
            <div class="rod-wrapper">
                <input type="checkbox" class="led-checkbox" data-light="4" data-rod="4" data-end="top" id="led-4">
                <div class="rod" data-rod="4"></div>
                <input type="checkbox" class="led-checkbox" data-light="10" data-rod="4" data-end="bottom" id="led-10">
            </div>
            <div class="rod-wrapper">
                <input type="checkbox" class="led-checkbox" data-light="5" data-rod="5" data-end="top" id="led-5">
                <div class="rod" data-rod="5"></div>
                <input type="checkbox" class="led-checkbox" data-light="11" data-rod="5" data-end="bottom" id="led-11">
            </div>
            <div class="rod-wrapper">
                <input type="checkbox" class="led-checkbox" data-light="6" data-rod="6" data-end="top" id="led-6">
                <div class="rod" data-rod="6"></div>
                <input type="checkbox" class="led-checkbox" data-light="12" data-rod="6" data-end="bottom" id="led-12">
            </div>
        </div>
    </div>

    <div class="control-panel">
        <h2>Patterns</h2>
        <div class="pattern-options">
            <div class="pattern-option">
                <input type="radio" id="pattern-none" name="pattern" value="none" checked>
                <label for="pattern-none">None</label>
            </div>
            <div class="pattern-option">
                <input type="radio" id="pattern-bounce" name="pattern" value="bounce">
                <label for="pattern-bounce">Bounce</label>
            </div>
            <div class="pattern-option">
                <input type="radio" id="pattern-random" name="pattern" value="random">
                <label for="pattern-random">Random</label>
            </div>
            <div class="pattern-option">
                <input type="radio" id="pattern-wave" name="pattern" value="wave">
                <label for="pattern-wave">Wave</label>
            </div>
            <div class="pattern-option">
                <input type="radio" id="pattern-snake" name="pattern" value="snake">
                <label for="pattern-snake">Snake</label>
            </div>
            <div class="pattern-option">
                <input type="radio" id="pattern-sparkle" name="pattern" value="sparkle">
                <label for="pattern-sparkle">Sparkle</label>
            </div>
            <div class="pattern-option">
                <input type="radio" id="pattern-waterfall" name="pattern" value="waterfall">
                <label for="pattern-waterfall">Waterfall</label>
            </div>
            <div class="pattern-option">
                <input type="radio" id="pattern-breathing" name="pattern" value="breathing">
                <label for="pattern-breathing">Breathing</label>
            </div>
        </div>
    </div>

    <script>
        const rods = document.querySelectorAll('.rod');
        const ledCheckboxes = document.querySelectorAll('.led-checkbox');

        // Bright green LED color
        const LED_COLOR = { r: 0, g: 255, b: 0 };

        // Light state: tracks which lights are on
        const lightState = {};

        const bouncePatternTemplate = function*() {
            while(true) {
                // Moving right
                yield `000000
                       100000`
                yield `000000
                       010000`
                yield `000000
                       001000`
                yield `000000
                       000100`
                yield `000000
                       000010`
                yield `000000
                       000001`
                // Moving left
                yield `000000
                       000010`
                yield `000000
                       000100`
                yield `000000
                       001000`
                yield `000000
                       010000`
            }
        }

        const randomPatternTemplate = function*() {
            while(true) {
                // Pick a random number of lights (0-12)
                const numLights = Math.floor(Math.random() * 13);

                // Create array of all light positions [0-11]
                const allLights = Array.from({length: 12}, (_, i) => i);

                // Shuffle using Fisher-Yates
                for (let i = allLights.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [allLights[i], allLights[j]] = [allLights[j], allLights[i]];
                }

                // Create pattern string
                let topRow = ['0', '0', '0', '0', '0', '0'];
                let bottomRow = ['0', '0', '0', '0', '0', '0'];

                for (let i = 0; i < numLights; i++) {
                    const lightIndex = allLights[i];
                    if (lightIndex < 6) {
                        topRow[lightIndex] = '1';
                    } else {
                        bottomRow[lightIndex - 6] = '1';
                    }
                }

                yield `${topRow.join('')}
                       ${bottomRow.join('')}`;
            }
        }

        const wavePatternTemplate = function*() {
            while(true) {
                // Moving right
                yield `100000
                       010000`
                yield `010000
                       101000`
                yield `001000
                       010100`
                yield `000100
                       001010`
                yield `000010
                       000101`
                yield `000001
                       000010`
                // Moving left
                yield `000010
                       000101`
                yield `000100
                       001010`
                yield `001000
                       010100`
                yield `010000
                       101000`
            }
        }

        const snakePatternTemplate = function*() {
            while(true) {
                yield `111000
                       000000`
                yield `011100
                       000000`
                yield `001110
                       000000`
                yield `000111
                       000000`
                yield `000011
                       000001`
                yield `000001
                       000011`
                yield `000000
                       000111`
                yield `000000
                       001110`
                yield `000000
                       011100`
                yield `000000
                       111000`
                yield `100000
                       110000`
                yield `110000
                       100000`
            }
        }

        const sparklePatternTemplate = function*() {
            while(true) {
                // Create 1-3 random sparkles
                const numSparkles = Math.floor(Math.random() * 3) + 1;
                const allPositions = Array.from({length: 12}, (_, i) => i);

                // Shuffle
                for (let i = allPositions.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [allPositions[i], allPositions[j]] = [allPositions[j], allPositions[i]];
                }

                let topRow = ['0', '0', '0', '0', '0', '0'];
                let bottomRow = ['0', '0', '0', '0', '0', '0'];

                for (let i = 0; i < numSparkles; i++) {
                    const pos = allPositions[i];
                    if (pos < 6) {
                        topRow[pos] = '1';
                    } else {
                        bottomRow[pos - 6] = '1';
                    }
                }

                yield `${topRow.join('')}
                       ${bottomRow.join('')}`;
            }
        }

        const waterfallPatternTemplate = function*() {
            while(true) {
                // Cascade from left to right, top to bottom
                yield `100000
                       000000`
                yield `110000
                       100000`
                yield `111000
                       110000`
                yield `111100
                       111000`
                yield `111110
                       111100`
                yield `111111
                       111110`
                yield `011111
                       111111`
                yield `001111
                       011111`
                yield `000111
                       001111`
                yield `000011
                       000111`
                yield `000001
                       000011`
                yield `000000
                       000001`
                yield `000000
                       000000`
            }
        }

        const breathingPatternTemplate = function*() {
            while(true) {
                // Breathing in - gradually light up all lights
                yield `000000
                       000000`
                yield `000000
                       010000`
                yield `000000
                       011000`
                yield `010000
                       011000`
                yield `011000
                       011100`
                yield `011000
                       111100`
                yield `011100
                       111100`
                yield `111100
                       111110`
                yield `111100
                       111111`
                yield `111110
                       111111`
                yield `111111
                       111111`
                // Hold
                yield `111111
                       111111`
                yield `111111
                       111111`
                // Breathing out - gradually turn off
                yield `111110
                       111111`
                yield `111100
                       111111`
                yield `111100
                       111110`
                yield `111100
                       111100`
                yield `011100
                       111100`
                yield `011000
                       111100`
                yield `011000
                       011100`
                yield `010000
                       011000`
                yield `000000
                       011000`
                yield `000000
                       010000`
                yield `000000
                       000000`
                // Hold
                yield `000000
                       000000`
                yield `000000
                       000000`
            }
        }

        // Map light number to rod and end
        function getLightInfo(lightNumber) {
            // Lights 1-6 are top (rods 1-6)
            // Lights 7-12 are bottom (rods 1-6)
            if (lightNumber >= 1 && lightNumber <= 6) {
                return { rod: lightNumber, end: 'top' };
            } else if (lightNumber >= 7 && lightNumber <= 12) {
                return { rod: lightNumber - 6, end: 'bottom' };
            }
            return null;
        }

        // Toggle a light on or off
        function toggle(lightNumber, isOn) {
            lightState[lightNumber] = isOn;

            const info = getLightInfo(lightNumber);
            if (!info) return;

            const rodElement = document.querySelector(`.rod[data-rod="${info.rod}"]`);
            updateRodGradient(rodElement, info.rod);
        }

        function updateRodGradient(rodElement, rodNum) {
            // Find which lights are on for this rod
            const topLight = rodNum; // Lights 1-6
            const bottomLight = rodNum + 6; // Lights 7-12

            const topLit = lightState[topLight] || false;
            const bottomLit = lightState[bottomLight] || false;

            if (!topLit && !bottomLit) {
                // No LEDs lit - transparent
                rodElement.style.background = 'transparent';
            } else if (topLit && !bottomLit) {
                // Top LED lit - gradient from top (70% opacity) to bottom (0% opacity)
                rodElement.style.background = `linear-gradient(to bottom,
                    rgba(${LED_COLOR.r}, ${LED_COLOR.g}, ${LED_COLOR.b}, 0.7),
                    rgba(${LED_COLOR.r}, ${LED_COLOR.g}, ${LED_COLOR.b}, 0))`;
            } else if (!topLit && bottomLit) {
                // Bottom LED lit - gradient from bottom (70% opacity) to top (0% opacity)
                rodElement.style.background = `linear-gradient(to top,
                    rgba(${LED_COLOR.r}, ${LED_COLOR.g}, ${LED_COLOR.b}, 0.7),
                    rgba(${LED_COLOR.r}, ${LED_COLOR.g}, ${LED_COLOR.b}, 0))`;
            } else {
                // Both LEDs lit - bright at both ends, transparent in middle
                rodElement.style.background = `linear-gradient(to bottom,
                    rgba(${LED_COLOR.r}, ${LED_COLOR.g}, ${LED_COLOR.b}, 0.7) 0%,
                    rgba(${LED_COLOR.r}, ${LED_COLOR.g}, ${LED_COLOR.b}, 0.7) 100%)`;
            }
        }

        // Add event listeners to LED checkboxes
        ledCheckboxes.forEach(checkbox => {
            checkbox.addEventListener('change', (e) => {
                const lightNumber = parseInt(e.target.dataset.light);
                toggle(lightNumber, e.target.checked);
            });
        });

        // Initialize light state
        for (let i = 1; i <= 12; i++) {
            lightState[i] = false;
        }

        // Initialize all rod gradients
        rods.forEach(rod => {
            const rodNum = parseInt(rod.dataset.rod);
            updateRodGradient(rod, rodNum);
        });

        // Make toggle function available globally for testing/debugging
        window.toggle = toggle;

        // Pattern control
        let animationTimer = null;
        let currentPatternGenerator = null;

        function clearAllLights() {
            for (let i = 1; i <= 12; i++) {
                toggle(i, false);
                const checkbox = document.querySelector(`#led-${i}`);
                if (checkbox) checkbox.checked = false;
            }
        }

        function stopAnimation() {
            if (animationTimer) {
                clearInterval(animationTimer);
                animationTimer = null;
            }
        }

        function applyPattern() {
            if (!currentPatternGenerator) return;

            // Get next pattern from generator
            const result = currentPatternGenerator.next();
            const patternString = result.value;

            // Parse the pattern string, extracting only 0s and 1s
            const digits = patternString.replace(/[^01]/g, '');

            // Clear all lights first
            clearAllLights();

            // First 6 digits are top LEDs (1-6)
            // Next 6 digits are bottom LEDs (7-12)
            for (let i = 0; i < digits.length && i < 12; i++) {
                if (digits[i] === '1') {
                    const lightNumber = i + 1;
                    toggle(lightNumber, true);
                }
            }
        }

        // Event listeners for pattern radio buttons
        const patternRadios = document.querySelectorAll('input[name="pattern"]');
        patternRadios.forEach(radio => {
            radio.addEventListener('change', (e) => {
                stopAnimation();

                if (e.target.value === 'bounce') {
                    // Create bounce generator and start animation
                    currentPatternGenerator = bouncePatternTemplate();
                    animationTimer = setInterval(applyPattern, 500);
                } else if (e.target.value === 'random') {
                    // Create random generator and start animation
                    currentPatternGenerator = randomPatternTemplate();
                    animationTimer = setInterval(applyPattern, 1000);
                } else if (e.target.value === 'wave') {
                    // Create wave generator and start animation
                    currentPatternGenerator = wavePatternTemplate();
                    animationTimer = setInterval(applyPattern, 400);
                } else if (e.target.value === 'snake') {
                    // Create snake generator and start animation
                    currentPatternGenerator = snakePatternTemplate();
                    animationTimer = setInterval(applyPattern, 500);
                } else if (e.target.value === 'sparkle') {
                    // Create sparkle generator and start animation
                    currentPatternGenerator = sparklePatternTemplate();
                    animationTimer = setInterval(applyPattern, 300);
                } else if (e.target.value === 'waterfall') {
                    // Create waterfall generator and start animation
                    currentPatternGenerator = waterfallPatternTemplate();
                    animationTimer = setInterval(applyPattern, 200);
                } else if (e.target.value === 'breathing') {
                    // Create breathing generator and start animation
                    currentPatternGenerator = breathingPatternTemplate();
                    animationTimer = setInterval(applyPattern, 300);
                } else if (e.target.value === 'none') {
                    // Just stop the animation, keep current light state
                    currentPatternGenerator = null;
                }
            });
        });
    </script>
</body>
</html>
